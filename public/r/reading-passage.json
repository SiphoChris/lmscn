{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "reading-passage",
  "type": "registry:component",
  "title": "Reading Passage",
  "description": "Three-phase reading comprehension: passage view → inline questions → results. Supports plain text or HTML and optional passage-hiding.",
  "registryDependencies": [
    "button",
    "card",
    "badge",
    "progress",
    "scroll-area",
    "separator"
  ],
  "files": [
    {
      "path": "registry/default/reading-passage/reading-passage.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { useState, useCallback } from \"react\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Progress } from \"@/components/ui/progress\"\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardTitle,\n  CardDescription,\n} from \"@/components/ui/card\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { BookOpen, ChevronRight, CheckCircle2, XCircle } from \"lucide-react\"\n\n// ─── Types ────────────────────────────────────────────────────────────────────\n\nexport type ReadingQuestionType = \"single\" | \"multiple\" | \"true-false\"\n\nexport interface ReadingQuestionOption {\n  id: string\n  label: string\n}\n\nexport interface ReadingQuestion {\n  id: string\n  type: ReadingQuestionType\n  question: string\n  options: ReadingQuestionOption[]\n  correctIds: string[]\n  /** Shown after the question is answered */\n  explanation?: string\n}\n\nexport interface ReadingPassageData {\n  title: string\n  introduction?: string\n  /**\n   * The reading content.\n   * Plain text by default; set `contentIsHtml: true` to render as HTML.\n   */\n  content: string\n  /** Render content as HTML (default: false) */\n  contentIsHtml?: boolean\n  questions: ReadingQuestion[]\n  /** Estimated reading time in minutes */\n  readingTimeMinutes?: number\n  /** Hide the passage while the user answers questions (default: false) */\n  hidePassageOnQuestions?: boolean\n}\n\nexport interface ReadingAnswer {\n  questionId: string\n  selected: string[]\n  correct: boolean\n}\n\nexport interface ReadingResult {\n  answers: ReadingAnswer[]\n  score: number\n  maxScore: number\n  percentage: number\n}\n\nexport interface ReadingPassageProps {\n  readingPassageData: ReadingPassageData\n  onComplete?: (result: ReadingResult) => void\n  className?: string\n}\n\n// ─── Internal phase ───────────────────────────────────────────────────────────\n\ntype Phase = \"reading\" | \"questions\" | \"results\"\n\n// ─── Component ────────────────────────────────────────────────────────────────\n\nexport function ReadingPassage({\n  readingPassageData,\n  onComplete,\n  className,\n}: ReadingPassageProps) {\n  const {\n    title,\n    introduction,\n    content,\n    contentIsHtml = false,\n    questions,\n    readingTimeMinutes,\n    hidePassageOnQuestions = false,\n  } = readingPassageData\n\n  const [phase, setPhase] = useState<Phase>(\"reading\")\n  const [qIndex, setQIndex] = useState(0)\n  const [selected, setSelected] = useState<string[]>([])\n  const [submitted, setSubmitted] = useState(false)\n  const [answers, setAnswers] = useState<ReadingAnswer[]>([])\n\n  const question = questions[qIndex]\n\n  const toggleOption = (id: string) => {\n    if (submitted) return\n    const isMultiple = question.type === \"multiple\"\n    if (isMultiple) {\n      setSelected((prev) =>\n        prev.includes(id) ? prev.filter((x) => x !== id) : [...prev, id]\n      )\n    } else {\n      setSelected([id])\n    }\n  }\n\n  const isCorrectOption = (id: string) => question.correctIds.includes(id)\n\n  const optionState = (id: string) => {\n    if (!submitted) return selected.includes(id) ? \"selected\" : \"idle\"\n    if (isCorrectOption(id)) return \"correct\"\n    if (selected.includes(id)) return \"wrong\"\n    return \"idle\"\n  }\n\n  const handleNext = useCallback(() => {\n    const ans: ReadingAnswer = {\n      questionId: question.id,\n      selected,\n      correct:\n        [...question.correctIds].sort().join(\",\") ===\n        [...selected].sort().join(\",\"),\n    }\n    const newAnswers = [...answers, ans]\n    setAnswers(newAnswers)\n\n    if (qIndex + 1 >= questions.length) {\n      const score = newAnswers.filter((a) => a.correct).length\n      const res: ReadingResult = {\n        answers: newAnswers,\n        score,\n        maxScore: questions.length,\n        percentage: Math.round((score / questions.length) * 100),\n      }\n      setPhase(\"results\")\n      onComplete?.(res)\n    } else {\n      setQIndex((i) => i + 1)\n      setSelected([])\n      setSubmitted(false)\n    }\n  }, [question, selected, answers, qIndex, questions.length, onComplete])\n\n  const PassageContent = () =>\n    contentIsHtml ? (\n      <div\n        className=\"prose prose-sm dark:prose-invert max-w-none\"\n        dangerouslySetInnerHTML={{ __html: content }}\n      />\n    ) : (\n      <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">\n        {content}\n      </p>\n    )\n\n  // ── Reading ───────────────────────────────────────────────────────────────\n  if (phase === \"reading\") {\n    return (\n      <Card className={cn(\"w-full max-w-3xl mx-auto\", className)}>\n        <CardHeader>\n          <div className=\"flex items-center gap-2 mb-1\">\n            <BookOpen className=\"size-4 text-muted-foreground\" />\n            <span className=\"text-xs text-muted-foreground uppercase tracking-wide font-medium\">\n              Reading Passage\n            </span>\n            {readingTimeMinutes && (\n              <Badge variant=\"secondary\" className=\"ml-auto text-xs\">\n                ~{readingTimeMinutes} min read\n              </Badge>\n            )}\n          </div>\n          <CardTitle className=\"text-xl\">{title}</CardTitle>\n          {introduction && (\n            <CardDescription>{introduction}</CardDescription>\n          )}\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Separator />\n          <ScrollArea className=\"max-h-[400px] pr-4\">\n            <PassageContent />\n          </ScrollArea>\n          <Separator />\n          <div className=\"flex justify-between items-center\">\n            <p className=\"text-sm text-muted-foreground\">\n              {questions.length} comprehension question\n              {questions.length > 1 ? \"s\" : \"\"}\n            </p>\n            <Button onClick={() => setPhase(\"questions\")}>\n              Start Questions\n              <ChevronRight className=\"ml-1 size-4\" />\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  // ── Results ───────────────────────────────────────────────────────────────\n  if (phase === \"results\") {\n    const score = answers.filter((a) => a.correct).length\n    const pct = Math.round((score / questions.length) * 100)\n    return (\n      <Card className={cn(\"w-full max-w-3xl mx-auto\", className)}>\n        <CardHeader className=\"text-center\">\n          <CardTitle className=\"text-2xl\">\n            Comprehension Check Complete\n          </CardTitle>\n          <CardDescription>{title}</CardDescription>\n        </CardHeader>\n        <CardContent className=\"text-center space-y-4\">\n          <p className=\"text-5xl font-bold\">{pct}%</p>\n          <p className=\"text-muted-foreground\">\n            {score} / {questions.length} correct\n          </p>\n          <div className=\"space-y-2 text-left mt-4\">\n            {answers.map((ans, i) => (\n              <div\n                key={ans.questionId}\n                className=\"flex items-center gap-2 text-sm\"\n              >\n                {ans.correct ? (\n                  <CheckCircle2 className=\"size-4 text-green-600 shrink-0\" />\n                ) : (\n                  <XCircle className=\"size-4 text-destructive shrink-0\" />\n                )}\n                <span>{questions[i].question}</span>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  // ── Questions ─────────────────────────────────────────────────────────────\n  return (\n    <div className={cn(\"w-full max-w-3xl mx-auto space-y-4\", className)}>\n      {!hidePassageOnQuestions && (\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-base flex items-center gap-2\">\n              <BookOpen className=\"size-4\" /> {title}\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ScrollArea className=\"max-h-44 pr-2\">\n              <PassageContent />\n            </ScrollArea>\n          </CardContent>\n        </Card>\n      )}\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between mb-1\">\n            <Badge variant=\"outline\">\n              Question {qIndex + 1} / {questions.length}\n            </Badge>\n            {question.type === \"multiple\" && (\n              <Badge variant=\"secondary\">Select all that apply</Badge>\n            )}\n          </div>\n          <CardTitle className=\"text-base leading-snug\">\n            {question.question}\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-2\">\n          {question.options.map((opt) => {\n            const state = optionState(opt.id)\n            return (\n              <button\n                key={opt.id}\n                onClick={() => toggleOption(opt.id)}\n                className={cn(\n                  \"w-full flex items-start gap-3 rounded-lg border px-4 py-3 text-sm text-left transition-colors\",\n                  state === \"idle\" && \"hover:bg-muted/50\",\n                  state === \"selected\" && \"border-primary bg-primary/5\",\n                  state === \"correct\" &&\n                    \"border-green-500 bg-green-50 dark:bg-green-950/20\",\n                  state === \"wrong\" && \"border-destructive bg-destructive/5\"\n                )}\n              >\n                <span className=\"mt-0.5 shrink-0\">\n                  {state === \"correct\" && (\n                    <CheckCircle2 className=\"size-4 text-green-600\" />\n                  )}\n                  {state === \"wrong\" && (\n                    <XCircle className=\"size-4 text-destructive\" />\n                  )}\n                  {(state === \"idle\" || state === \"selected\") && (\n                    <span\n                      className={cn(\n                        \"inline-flex size-4 items-center justify-center rounded-full border text-[10px] font-bold\",\n                        state === \"selected\"\n                          ? \"border-primary bg-primary text-primary-foreground\"\n                          : \"border-muted-foreground\"\n                      )}\n                    />\n                  )}\n                </span>\n                {opt.label}\n              </button>\n            )\n          })}\n\n          {submitted && question.explanation && (\n            <div className=\"mt-2 rounded-md bg-muted px-4 py-3 text-sm text-muted-foreground\">\n              {question.explanation}\n            </div>\n          )}\n\n          <div className=\"flex justify-end pt-2\">\n            {!submitted ? (\n              <Button\n                onClick={() => setSubmitted(true)}\n                disabled={!selected.length}\n              >\n                Submit\n              </Button>\n            ) : (\n              <Button onClick={handleNext}>\n                {qIndex + 1 >= questions.length ? \"Finish\" : \"Next\"}\n                <ChevronRight className=\"ml-1 size-4\" />\n              </Button>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n",
      "type": "registry:component"
    }
  ]
}