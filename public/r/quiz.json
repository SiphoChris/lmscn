{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "quiz",
  "type": "registry:component",
  "title": "Quiz",
  "description": "Multi-type quiz (single-choice, multi-select, true/false) with per-question scoring, progress bar, answer explanations and a pass/fail results screen.",
  "registryDependencies": [
    "button",
    "card",
    "progress",
    "badge"
  ],
  "files": [
    {
      "path": "registry/default/quiz/quiz.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { useState, useCallback } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Card,\n  CardContent,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n  CardDescription,\n} from \"@/components/ui/card\";\nimport { CheckCircle2, XCircle, ChevronRight, Trophy } from \"lucide-react\";\n\n// ─── Types ────────────────────────────────────────────────────────────────────\n\nexport type QuizOptionId = string;\n\nexport interface QuizOption {\n  id: QuizOptionId;\n  label: string;\n  /** Shown beneath the option after the answer is revealed */\n  explanation?: string;\n}\n\nexport type QuizQuestionType = \"single\" | \"multiple\" | \"true-false\";\n\nexport interface QuizQuestion {\n  id: string;\n  type: QuizQuestionType;\n  question: string;\n  options: QuizOption[];\n  correctIds: QuizOptionId[];\n  hint?: string;\n  /** Points for a correct answer (default: 1) */\n  points?: number;\n}\n\nexport interface QuizData {\n  title: string;\n  description?: string;\n  questions: QuizQuestion[];\n  showExplanations?: boolean;\n  shuffle?: boolean;\n  /** Pass threshold as a percentage 0–100 (default: 70) */\n  passingScore?: number;\n}\n\nexport interface QuizResult {\n  score: number;\n  maxScore: number;\n  percentage: number;\n  passed: boolean;\n  answers: Record<string, QuizOptionId[]>;\n}\n\nexport interface QuizProps {\n  quizData: QuizData;\n  onComplete?: (result: QuizResult) => void;\n  className?: string;\n}\n\n// ─── Helpers ──────────────────────────────────────────────────────────────────\n\nfunction shuffleArray<T>(arr: T[]): T[] {\n  return [...arr].sort(() => Math.random() - 0.5);\n}\n\n// ─── Component ────────────────────────────────────────────────────────────────\n\nexport function Quiz({ quizData, onComplete, className }: QuizProps) {\n  const {\n    title,\n    description,\n    showExplanations = true,\n    shuffle = false,\n    passingScore = 70,\n  } = quizData;\n\n  const questions = React.useMemo(\n    () => (shuffle ? shuffleArray(quizData.questions) : quizData.questions),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [],\n  );\n\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [selected, setSelected] = useState<QuizOptionId[]>([]);\n  const [submitted, setSubmitted] = useState(false);\n  const [answers, setAnswers] = useState<Record<string, QuizOptionId[]>>({});\n  const [finished, setFinished] = useState(false);\n  const [result, setResult] = useState<QuizResult | null>(null);\n\n  const question = questions[currentIndex];\n  const isMultiple = question.type === \"multiple\";\n  const progress =\n    ((currentIndex + (submitted ? 1 : 0)) / questions.length) * 100;\n\n  const toggleOption = useCallback(\n    (id: QuizOptionId) => {\n      if (submitted) return;\n      if (isMultiple) {\n        setSelected((prev) =>\n          prev.includes(id) ? prev.filter((x) => x !== id) : [...prev, id],\n        );\n      } else {\n        setSelected([id]);\n      }\n    },\n    [submitted, isMultiple],\n  );\n\n  const handleSubmit = useCallback(() => {\n    if (selected.length === 0) return;\n    setSubmitted(true);\n    setAnswers((prev) => ({ ...prev, [question.id]: selected }));\n  }, [selected, question.id]);\n\n  const handleNext = useCallback(() => {\n    if (currentIndex + 1 >= questions.length) {\n      const allAnswers = { ...answers, [question.id]: selected };\n      let score = 0;\n      let maxScore = 0;\n      for (const q of questions) {\n        const pts = q.points ?? 1;\n        maxScore += pts;\n        const given = allAnswers[q.id] ?? [];\n        if (\n          [...q.correctIds].sort().join(\",\") === [...given].sort().join(\",\")\n        ) {\n          score += pts;\n        }\n      }\n      const percentage = Math.round((score / maxScore) * 100);\n      const res: QuizResult = {\n        score,\n        maxScore,\n        percentage,\n        passed: percentage >= passingScore,\n        answers: allAnswers,\n      };\n      setResult(res);\n      setFinished(true);\n      onComplete?.(res);\n    } else {\n      setCurrentIndex((i) => i + 1);\n      setSelected([]);\n      setSubmitted(false);\n    }\n  }, [\n    currentIndex,\n    questions,\n    answers,\n    question.id,\n    selected,\n    passingScore,\n    onComplete,\n  ]);\n\n  const isCorrect = useCallback(\n    (id: QuizOptionId) => question.correctIds.includes(id),\n    [question.correctIds],\n  );\n\n  const optionState = (id: QuizOptionId) => {\n    if (!submitted) return selected.includes(id) ? \"selected\" : \"idle\";\n    if (isCorrect(id)) return \"correct\";\n    if (selected.includes(id)) return \"wrong\";\n    return \"idle\";\n  };\n\n  // ── Results screen ────────────────────────────────────────────────────────\n  if (finished && result) {\n    return (\n      <Card className={cn(\"w-full max-w-2xl mx-auto\", className)}>\n        <CardHeader className=\"text-center pb-2\">\n          <div className=\"flex justify-center mb-4\">\n            <Trophy\n              className={cn(\n                \"size-16\",\n                result.passed ? \"text-yellow-500\" : \"text-muted-foreground\",\n              )}\n            />\n          </div>\n          <CardTitle className=\"text-2xl\">\n            {result.passed ? \"Quiz Complete!\" : \"Better luck next time\"}\n          </CardTitle>\n          <CardDescription>\n            {result.passed\n              ? \"Great job — you passed!\"\n              : `You needed ${passingScore}% to pass.`}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4 text-center\">\n          <p className=\"text-5xl font-bold\">{result.percentage}%</p>\n          <p className=\"text-muted-foreground\">\n            {result.score} / {result.maxScore} points\n          </p>\n          <Badge variant={result.passed ? \"default\" : \"destructive\"}>\n            {result.passed ? \"Passed\" : \"Failed\"}\n          </Badge>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  // ── Question screen ───────────────────────────────────────────────────────\n  return (\n    <Card className={cn(\"w-full max-w-2xl mx-auto\", className)}>\n      <CardHeader>\n        <div className=\"flex items-center justify-between mb-1\">\n          <Badge variant=\"outline\">\n            {currentIndex + 1} / {questions.length}\n          </Badge>\n          {question.points && question.points > 1 && (\n            <Badge variant=\"secondary\">{question.points} pts</Badge>\n          )}\n        </div>\n        <Progress value={progress} className=\"h-1.5 mb-3\" />\n        <CardTitle className=\"text-lg leading-snug\">{title}</CardTitle>\n        {description && <CardDescription>{description}</CardDescription>}\n      </CardHeader>\n\n      <CardContent className=\"space-y-4\">\n        <p className=\"font-medium text-base\">{question.question}</p>\n        {question.hint && !submitted && (\n          <p className=\"text-sm text-muted-foreground italic\">\n            Hint: {question.hint}\n          </p>\n        )}\n        {isMultiple && !submitted && (\n          <p className=\"text-xs text-muted-foreground\">\n            Select all that apply.\n          </p>\n        )}\n\n        <ul\n          className=\"space-y-2\"\n          role=\"listbox\"\n          aria-multiselectable={isMultiple}\n        >\n          {question.options.map((opt) => {\n            const state = optionState(opt.id);\n            return (\n              <li key={opt.id}>\n                <button\n                  role=\"option\"\n                  aria-selected={selected.includes(opt.id)}\n                  onClick={() => toggleOption(opt.id)}\n                  className={cn(\n                    \"w-full flex items-start gap-3 rounded-lg border px-4 py-3 text-sm text-left transition-colors\",\n                    state === \"idle\" && \"hover:bg-muted/50 border-border\",\n                    state === \"selected\" && \"border-primary bg-primary/5\",\n                    state === \"correct\" &&\n                      \"border-green-500 bg-green-50 dark:bg-green-950/20\",\n                    state === \"wrong\" && \"border-destructive bg-destructive/5\",\n                  )}\n                >\n                  <span className=\"mt-0.5 shrink-0\">\n                    {state === \"correct\" && (\n                      <CheckCircle2 className=\"size-4 text-green-600\" />\n                    )}\n                    {state === \"wrong\" && (\n                      <XCircle className=\"size-4 text-destructive\" />\n                    )}\n                    {(state === \"idle\" || state === \"selected\") && (\n                      <span\n                        className={cn(\n                          \"inline-flex size-4 items-center justify-center rounded-full border text-[10px] font-bold\",\n                          state === \"selected\"\n                            ? \"border-primary bg-primary text-primary-foreground\"\n                            : \"border-muted-foreground\",\n                        )}\n                      />\n                    )}\n                  </span>\n                  <span className=\"flex-1\">\n                    {opt.label}\n                    {submitted && showExplanations && opt.explanation && (\n                      <span className=\"block mt-1 text-xs text-muted-foreground\">\n                        {opt.explanation}\n                      </span>\n                    )}\n                  </span>\n                </button>\n              </li>\n            );\n          })}\n        </ul>\n      </CardContent>\n\n      <CardFooter className=\"flex justify-end gap-2\">\n        {!submitted ? (\n          <Button onClick={handleSubmit} disabled={selected.length === 0}>\n            Submit Answer\n          </Button>\n        ) : (\n          <Button onClick={handleNext}>\n            {currentIndex + 1 >= questions.length ? \"See Results\" : \"Next\"}\n            <ChevronRight className=\"ml-1 size-4\" />\n          </Button>\n        )}\n      </CardFooter>\n    </Card>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}