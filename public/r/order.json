{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "order",
  "type": "registry:component",
  "title": "Order / Sequence",
  "description": "Drag-and-drop (or ↑↓ keyboard) item-sequencing exercise that reveals the correct order on failure.",
  "registryDependencies": [
    "button",
    "progress",
    "badge"
  ],
  "files": [
    {
      "path": "registry/default/order/order.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { useState, useCallback, useRef } from \"react\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Progress } from \"@/components/ui/progress\"\nimport {\n  GripVertical,\n  CheckCircle2,\n  XCircle,\n  ChevronRight,\n  RotateCcw,\n} from \"lucide-react\"\n\n// ─── Types ────────────────────────────────────────────────────────────────────\n\nexport interface OrderItem {\n  id: string\n  label: string\n  /** Optional sub-label shown below the main label */\n  description?: string\n}\n\nexport interface OrderQuestion {\n  id: string\n  prompt: string\n  /** Items listed in CORRECT order */\n  items: OrderItem[]\n  hint?: string\n}\n\nexport interface OrderData {\n  title: string\n  description?: string\n  questions: OrderQuestion[]\n}\n\nexport interface OrderAttempt {\n  questionId: string\n  givenOrder: string[]\n  correctOrder: string[]\n  correct: boolean\n}\n\nexport interface OrderResult {\n  attempts: OrderAttempt[]\n  score: number\n  maxScore: number\n  percentage: number\n}\n\nexport interface OrderProps {\n  orderData: OrderData\n  onComplete?: (result: OrderResult) => void\n  className?: string\n}\n\n// ─── Helpers ──────────────────────────────────────────────────────────────────\n\nfunction shuffleArray<T>(arr: T[]): T[] {\n  const a = [...arr]\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1))\n    ;[a[i], a[j]] = [a[j], a[i]]\n  }\n  return a\n}\n\n// ─── Component ────────────────────────────────────────────────────────────────\n\nexport function Order({ orderData, onComplete, className }: OrderProps) {\n  const { title, description, questions } = orderData\n\n  const [index, setIndex] = useState(0)\n  const [submitted, setSubmitted] = useState(false)\n  const [attempts, setAttempts] = useState<OrderAttempt[]>([])\n  const [finished, setFinished] = useState(false)\n\n  const question = questions[index]\n\n  const [items, setItems] = useState<OrderItem[]>(() =>\n    shuffleArray(question.items)\n  )\n\n  const progress = (index / questions.length) * 100\n\n  React.useEffect(() => {\n    setItems(shuffleArray(question.items))\n    setSubmitted(false)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [index])\n\n  // ── Drag state ───────────────────────────────────────────────────────────\n  const dragIdx = useRef<number | null>(null)\n  const [dragOver, setDragOver] = useState<number | null>(null)\n\n  const handleDragStart = useCallback((i: number) => {\n    dragIdx.current = i\n  }, [])\n\n  const handleDrop = useCallback((targetIdx: number) => {\n    if (dragIdx.current === null || dragIdx.current === targetIdx) return\n    setItems((prev) => {\n      const next = [...prev]\n      const [moved] = next.splice(dragIdx.current!, 1)\n      next.splice(targetIdx, 0, moved)\n      return next\n    })\n    dragIdx.current = null\n    setDragOver(null)\n  }, [])\n\n  // Keyboard reorder (↑ / ↓)\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent, i: number) => {\n      if (submitted) return\n      if (e.key === \"ArrowUp\" && i > 0) {\n        e.preventDefault()\n        setItems((prev) => {\n          const next = [...prev]\n          ;[next[i - 1], next[i]] = [next[i], next[i - 1]]\n          return next\n        })\n      }\n      if (e.key === \"ArrowDown\" && i < items.length - 1) {\n        e.preventDefault()\n        setItems((prev) => {\n          const next = [...prev]\n          ;[next[i], next[i + 1]] = [next[i + 1], next[i]]\n          return next\n        })\n      }\n    },\n    [submitted, items.length]\n  )\n\n  const correctOrder = question.items.map((x) => x.id)\n  const givenOrder = items.map((x) => x.id)\n  const isCorrect = givenOrder.join(\",\") === correctOrder.join(\",\")\n\n  const handleSubmit = useCallback(() => setSubmitted(true), [])\n\n  const handleNext = useCallback(() => {\n    const attempt: OrderAttempt = {\n      questionId: question.id,\n      givenOrder,\n      correctOrder,\n      correct: isCorrect,\n    }\n    const newAttempts = [...attempts, attempt]\n    setAttempts(newAttempts)\n\n    if (index + 1 >= questions.length) {\n      const score = newAttempts.filter((a) => a.correct).length\n      const res: OrderResult = {\n        attempts: newAttempts,\n        score,\n        maxScore: questions.length,\n        percentage: Math.round((score / questions.length) * 100),\n      }\n      setFinished(true)\n      onComplete?.(res)\n    } else {\n      setIndex((i) => i + 1)\n    }\n  }, [\n    question.id,\n    givenOrder,\n    correctOrder,\n    isCorrect,\n    attempts,\n    index,\n    questions.length,\n    onComplete,\n  ])\n\n  // ── Finished ──────────────────────────────────────────────────────────────\n  if (finished) {\n    const score = attempts.filter((a) => a.correct).length\n    const pct = Math.round((score / questions.length) * 100)\n    return (\n      <div\n        className={cn(\n          \"w-full max-w-xl mx-auto text-center space-y-4\",\n          className\n        )}\n      >\n        <h2 className=\"text-2xl font-bold\">Done!</h2>\n        <p className=\"text-5xl font-bold\">{pct}%</p>\n        <p className=\"text-muted-foreground\">\n          {score} / {questions.length} correct\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <div className={cn(\"w-full max-w-xl mx-auto space-y-5\", className)}>\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"font-semibold text-lg\">{title}</h2>\n          {description && (\n            <p className=\"text-sm text-muted-foreground\">{description}</p>\n          )}\n        </div>\n        <Badge variant=\"outline\">\n          {index + 1} / {questions.length}\n        </Badge>\n      </div>\n\n      <Progress value={progress} className=\"h-1.5\" />\n\n      <div className=\"space-y-3\">\n        <p className=\"font-medium\">{question.prompt}</p>\n        {question.hint && !submitted && (\n          <p className=\"text-sm text-muted-foreground italic\">\n            Hint: {question.hint}\n          </p>\n        )}\n        {!submitted && (\n          <p className=\"text-xs text-muted-foreground\">\n            Drag items or use ↑↓ keys to reorder.\n          </p>\n        )}\n\n        <ul className=\"space-y-2\" aria-label=\"Sortable list\">\n          {items.map((item, i) => {\n            const posInCorrect = correctOrder.indexOf(item.id)\n            const itemCorrect = submitted && posInCorrect === i\n            const itemWrong = submitted && posInCorrect !== i\n\n            return (\n              <li\n                key={item.id}\n                draggable={!submitted}\n                onDragStart={() => handleDragStart(i)}\n                onDragOver={(e) => {\n                  e.preventDefault()\n                  setDragOver(i)\n                }}\n                onDrop={() => handleDrop(i)}\n                onDragLeave={() => setDragOver(null)}\n                onKeyDown={(e) => handleKeyDown(e, i)}\n                tabIndex={submitted ? -1 : 0}\n                role=\"listitem\"\n                aria-label={`Position ${i + 1}: ${item.label}`}\n                className={cn(\n                  \"flex items-center gap-3 rounded-lg border px-4 py-3 text-sm transition-all\",\n                  !submitted &&\n                    \"cursor-grab active:cursor-grabbing hover:bg-muted/50\",\n                  dragOver === i &&\n                    !submitted &&\n                    \"border-primary bg-primary/5\",\n                  itemCorrect &&\n                    \"border-green-500 bg-green-50 dark:bg-green-950/20\",\n                  itemWrong && \"border-destructive bg-destructive/5\"\n                )}\n              >\n                {!submitted && (\n                  <GripVertical className=\"size-4 text-muted-foreground shrink-0\" />\n                )}\n                <span className=\"shrink-0 text-xs font-mono text-muted-foreground w-5\">\n                  {i + 1}.\n                </span>\n                <span className=\"flex-1\">\n                  <span className=\"font-medium\">{item.label}</span>\n                  {item.description && (\n                    <span className=\"block text-xs text-muted-foreground\">\n                      {item.description}\n                    </span>\n                  )}\n                </span>\n                {itemCorrect && (\n                  <CheckCircle2 className=\"size-4 text-green-600 shrink-0\" />\n                )}\n                {itemWrong && (\n                  <XCircle className=\"size-4 text-destructive shrink-0\" />\n                )}\n              </li>\n            )\n          })}\n        </ul>\n\n        {submitted && !isCorrect && (\n          <div className=\"rounded-md bg-muted px-4 py-3 text-sm space-y-1\">\n            <p className=\"font-medium\">Correct order:</p>\n            {correctOrder.map((id, i) => {\n              const itm = question.items.find((x) => x.id === id)!\n              return (\n                <p key={id} className=\"text-muted-foreground\">\n                  {i + 1}. {itm.label}\n                </p>\n              )\n            })}\n          </div>\n        )}\n      </div>\n\n      <div className=\"flex justify-between\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={() => {\n            setItems(shuffleArray(question.items))\n            setSubmitted(false)\n          }}\n          disabled={submitted}\n        >\n          <RotateCcw className=\"mr-1.5 size-3.5\" />\n          Shuffle\n        </Button>\n        {!submitted ? (\n          <Button onClick={handleSubmit}>Check Order</Button>\n        ) : (\n          <Button onClick={handleNext}>\n            {index + 1 >= questions.length ? \"See Results\" : \"Next\"}\n            <ChevronRight className=\"ml-1 size-4\" />\n          </Button>\n        )}\n      </div>\n    </div>\n  )\n}\n",
      "type": "registry:component"
    }
  ]
}